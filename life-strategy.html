<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Life Strategy Matrix — Ben Siverly</title>
  <meta name="description" content="Make and print a life strategy matrix to focus your energy on what matters most.">

  <!-- Open Graph -->
  <meta property="og:title" content="Life Strategy Matrix — Ben Siverly">
  <meta property="og:description" content="Make and print a life strategy matrix to focus your energy on what matters most.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://benjaminsiverly.ly/life-strategy.html">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Life Strategy Matrix — Ben Siverly">
  <meta name="twitter:description" content="Make and print a life strategy matrix to focus your energy on what matters most.">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Zilla+Slab:wght@600;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css">
</head>
<body class="life-strategy-page">
  <header class="site-header">
    <a href="index.html" class="site-brand" aria-label="Return to home">BS.</a>
    <a class="page-link" href="index.html">Back to home</a>
  </header>

  <main>
    <section class="hero" aria-labelledby="life-strategy-heading">
      <p class="location">Tool</p>
      <h1 id="life-strategy-heading">Life Strategy Matrix</h1>
      <div class="hero-content">
        <p>Take 5 minutes to map out what matters. Score your life across key areas, see where you're out of balance, and get one clear focus to act on right now.</p>
      </div>
    </section>

    <hr class="section-divider">

    <section class="tools" aria-labelledby="tools-heading">
      <h2 id="tools-heading">Build your strategy</h2>
      <p class="section-intro">This stays private—nothing is saved. Work through the guided steps below, identify your single most important focus, then print a one-page plan you can reference all month.</p>
      <article class="tool-card tool-card--featured">
        <div class="tool-header">
          <div class="tool-header-row">
            <h3>Life Strategy Wizard</h3>
            <div class="tool-header-actions">
              <span class="status">Printable</span>
            </div>
          </div>
          <p>Set importance, rate satisfaction, review your matrix, and print the plan.</p>
        </div>
        <div class="life-tool">
          <div class="wizard" id="life-wizard">
            <header class="wizard-header">
              <div class="wizard-progress-bar" id="wizard-progress-bar" role="progressbar" aria-valuemin="1" aria-valuemax="4" aria-valuenow="1">
                <div class="wizard-progress-fill"></div>
              </div>
              <div class="wizard-step-indicator">
                <span class="wizard-step-current" id="wizard-step-label">Step 1 of 4</span>
                <span class="wizard-step-name" id="wizard-step-name">Importance</span>
              </div>
              <h3 class="wizard-title" id="wizard-title">What matters most?</h3>
              <p class="wizard-microcopy" id="wizard-microcopy">Rate how important each area is to you right now.</p>
            </header>

            <div class="wizard-body">
              <div class="wizard-card" id="wizard-step-content" aria-live="polite"></div>
            </div>

            <footer class="wizard-footer">
              <div class="wizard-nav">
                <button class="wizard-nav-btn wizard-nav-btn--back" type="button" id="wizard-back" aria-label="Go back">
                  <span class="wizard-nav-icon">←</span>
                  <span class="wizard-nav-text">Back</span>
                </button>
                <div class="wizard-nav-center">
                  <span class="wizard-category-progress" id="wizard-progress">1 of 8</span>
                </div>
                <button class="wizard-nav-btn wizard-nav-btn--next" type="button" id="wizard-next">
                  <span class="wizard-nav-text">Next</span>
                  <span class="wizard-nav-icon">→</span>
                </button>
              </div>
              <div class="wizard-secondary-actions">
                <button class="wizard-link" type="button" id="wizard-skip">Skip this category</button>
                <button class="wizard-link" type="button" id="wizard-reset">Start over</button>
              </div>
              <p class="wizard-note" id="wizard-note" role="status" aria-live="polite"></p>
              <button class="wizard-preview-btn" type="button" id="wizard-preview" disabled>Jump to results</button>
            </footer>
          </div>
        </div>
      </article>
    </section>
  </main>

  <footer>
    <p class="copyright">© 2026 Ben Siverly</p>
  </footer>

  <script>
    (function() {
      var wizard = document.getElementById('life-wizard');
      if (!wizard) return;

      var categorySource = [
        { id: 'health', label: 'Health' },
        { id: 'work', label: 'Work' },
        { id: 'family', label: 'Family' },
        { id: 'spirituality', label: 'Spirituality' },
        { id: 'creative', label: 'Creative' },
        { id: 'relationships', label: 'Relationships' },
        { id: 'financial', label: 'Financial' },
        { id: 'rest', label: 'Rest' }
      ];

      var quadrantMeta = {
        maintain: {
          label: 'Maintain',
          note: "Keep doing what you're doing.",
          summary: "Important to you and you're satisfied. Keep it up."
        },
        invest: {
          label: 'Invest',
          note: 'This deserves more of your time.',
          summary: "Important to you but you're not satisfied. Focus here."
        },
        rebalance: {
          label: 'Rebalance',
          note: 'Consider easing back here.',
          summary: "You're satisfied but it's less important. Scale back if needed."
        },
        release: {
          label: 'Release',
          note: "It's okay to let this coast.",
          summary: "Less important and you're not satisfied. Let it be for now."
        }
      };

      var state = {
        categories: categorySource.map(function(category) {
          return {
            id: category.id,
            label: category.label,
            importance: null,
            satisfaction: null
          };
        }),
        currentStep: 1,
        currentCategoryIndex: 0,
        highlightedCategoryId: null
      };

      var elements = {
        title: document.getElementById('wizard-title'),
        microcopy: document.getElementById('wizard-microcopy'),
        stepLabel: document.getElementById('wizard-step-label'),
        stepName: document.getElementById('wizard-step-name'),
        progressBar: document.getElementById('wizard-progress-bar'),
        progress: document.getElementById('wizard-progress'),
        content: document.getElementById('wizard-step-content'),
        back: document.getElementById('wizard-back'),
        next: document.getElementById('wizard-next'),
        skip: document.getElementById('wizard-skip'),
        reset: document.getElementById('wizard-reset'),
        preview: document.getElementById('wizard-preview'),
        note: document.getElementById('wizard-note')
      };

      function getAverage(values) {
        var total = 0;
        var count = 0;
        values.forEach(function(value) {
          if (typeof value === 'number') {
            total += value;
            count += 1;
          }
        });
        return count ? total / count : 3;
      }

      function getSplits() {
        return {
          xSplit: getAverage(state.categories.map(function(category) { return category.importance; })),
          ySplit: getAverage(state.categories.map(function(category) { return category.satisfaction; }))
        };
      }

      function isComplete() {
        return state.categories.every(function(category) {
          return typeof category.importance === 'number' && typeof category.satisfaction === 'number';
        });
      }

      function getQuadrant(category, splits) {
        var isHighImportance = category.importance >= splits.xSplit;
        var isHighSatisfaction = category.satisfaction >= splits.ySplit;

        if (isHighImportance && isHighSatisfaction) return 'maintain';
        if (isHighImportance && !isHighSatisfaction) return 'invest';
        if (!isHighImportance && isHighSatisfaction) return 'rebalance';
        return 'release';
      }

      function getFocusNow(splits, quadrants) {
        var investPool = quadrants.invest;
        if (investPool.length) {
          var bestInvest = investPool.slice().sort(function(a, b) {
            return b.gapScore - a.gapScore;
          })[0];
          return {
            category: bestInvest,
            message: 'Your priority: ' + bestInvest.label + ". It's important to you, but you're not satisfied. This is where to invest your energy this month. What's one concrete thing you can do this week to move the needle?"
          };
        }

        if (quadrants.rebalance.length) {
          var easeOff = quadrants.rebalance.slice().sort(function(a, b) {
            return b.satisfaction - a.satisfaction;
          })[0];
          return {
            category: easeOff,
            message: 'Your priority: ' + easeOff.label + ". You're putting time in here and it's going well, but it's less important right now. Can you ease back a bit to create space for what matters more?"
          };
        }

        var farthest = state.categories.slice().sort(function(a, b) {
          var distanceA = Math.abs(a.importance - splits.xSplit) + Math.abs(a.satisfaction - splits.ySplit);
          var distanceB = Math.abs(b.importance - splits.xSplit) + Math.abs(b.satisfaction - splits.ySplit);
          return distanceB - distanceA;
        })[0];

        return {
          category: farthest,
          message: 'Your priority: ' + farthest.label + '. This has the biggest gap from your ideal balance. Pick one small shift you can make this month to get closer to where you want to be.'
        };
      }

      function getInitials(label) {
        return label.split(' ').map(function(word) { return word[0]; }).join('').slice(0, 2).toUpperCase();
      }

      function getPointPosition(value) {
        return ((value - 1) / 4) * 100;
      }

      function setHighlight(categoryId) {
        state.highlightedCategoryId = categoryId;
        updateHighlight();
      }

      function updateHighlight() {
        var highlightId = state.highlightedCategoryId;
        var listButtons = wizard.querySelectorAll('[data-category-button]');
        var points = wizard.querySelectorAll('[data-category-point]');

        listButtons.forEach(function(button) {
          button.classList.toggle('is-active', button.dataset.categoryButton === highlightId);
        });

        points.forEach(function(point) {
          point.classList.toggle('is-active', point.dataset.categoryPoint === highlightId);
        });

        updateTooltip();
      }

      function updateTooltip() {
        var tooltip = wizard.querySelector('.matrix-tooltip');
        var activePoint = wizard.querySelector('[data-category-point].is-active');

        if (!tooltip) return;
        if (!activePoint) {
          tooltip.classList.remove('is-visible');
          return;
        }

        var label = activePoint.getAttribute('data-label');
        var importance = activePoint.getAttribute('data-importance');
        var satisfaction = activePoint.getAttribute('data-satisfaction');
        tooltip.innerHTML = '<strong>' + label + '</strong><span>' + importance + '/5 importance · ' + satisfaction + '/5 satisfaction</span>';

        var container = activePoint.closest('.matrix-wrapper');
        if (!container) return;
        var containerRect = container.getBoundingClientRect();
        var pointRect = activePoint.getBoundingClientRect();
        tooltip.style.left = (pointRect.left - containerRect.left + pointRect.width / 2) + 'px';
        tooltip.style.top = (pointRect.top - containerRect.top - 12) + 'px';
        tooltip.classList.add('is-visible');
      }

      function buildMatrix(container, splits, options) {
        var svgNS = 'http://www.w3.org/2000/svg';
        var svg = document.createElementNS(svgNS, 'svg');
        svg.setAttribute('viewBox', '0 0 100 100');
        svg.setAttribute('role', 'img');
        svg.setAttribute('aria-label', 'Life strategy matrix');
        svg.classList.add('matrix-svg');

        var rect = document.createElementNS(svgNS, 'rect');
        rect.setAttribute('x', '0');
        rect.setAttribute('y', '0');
        rect.setAttribute('width', '100');
        rect.setAttribute('height', '100');
        rect.setAttribute('fill', 'none');
        rect.setAttribute('stroke', 'currentColor');
        rect.setAttribute('stroke-width', '0.8');
        svg.appendChild(rect);

        var xSplit = getPointPosition(splits.xSplit);
        var ySplit = 100 - getPointPosition(splits.ySplit);

        var xLine = document.createElementNS(svgNS, 'line');
        xLine.setAttribute('x1', xSplit);
        xLine.setAttribute('y1', '0');
        xLine.setAttribute('x2', xSplit);
        xLine.setAttribute('y2', '100');
        xLine.setAttribute('stroke', 'currentColor');
        xLine.setAttribute('stroke-width', '0.5');
        xLine.setAttribute('stroke-dasharray', '2 2');
        svg.appendChild(xLine);

        var yLine = document.createElementNS(svgNS, 'line');
        yLine.setAttribute('x1', '0');
        yLine.setAttribute('y1', ySplit);
        yLine.setAttribute('x2', '100');
        yLine.setAttribute('y2', ySplit);
        yLine.setAttribute('stroke', 'currentColor');
        yLine.setAttribute('stroke-width', '0.5');
        yLine.setAttribute('stroke-dasharray', '2 2');
        svg.appendChild(yLine);

        var labels = [
          { text: quadrantMeta.rebalance.label, x: xSplit / 2, y: ySplit / 2 },
          { text: quadrantMeta.maintain.label, x: xSplit + (100 - xSplit) / 2, y: ySplit / 2 },
          { text: quadrantMeta.release.label, x: xSplit / 2, y: ySplit + (100 - ySplit) / 2 },
          { text: quadrantMeta.invest.label, x: xSplit + (100 - xSplit) / 2, y: ySplit + (100 - ySplit) / 2 }
        ];

        labels.forEach(function(label) {
          var text = document.createElementNS(svgNS, 'text');
          text.setAttribute('x', label.x);
          text.setAttribute('y', label.y);
          text.setAttribute('text-anchor', 'middle');
          text.setAttribute('dominant-baseline', 'middle');
          text.classList.add('matrix-label');
          text.textContent = label.text;
          svg.appendChild(text);
        });

        state.categories.forEach(function(category) {
          if (typeof category.importance !== 'number' || typeof category.satisfaction !== 'number') return;
          var x = getPointPosition(category.importance);
          var y = 100 - getPointPosition(category.satisfaction);
          var group = document.createElementNS(svgNS, 'g');
          group.classList.add('matrix-point');
          group.setAttribute('data-category-point', category.id);
          group.setAttribute('data-label', category.label);
          group.setAttribute('data-importance', category.importance);
          group.setAttribute('data-satisfaction', category.satisfaction);
          group.setAttribute('tabindex', '0');

          var circle = document.createElementNS(svgNS, 'circle');
          circle.setAttribute('cx', x);
          circle.setAttribute('cy', y);
          circle.setAttribute('r', '2.5');
          circle.setAttribute('class', 'matrix-point-dot');
          group.appendChild(circle);

          var text = document.createElementNS(svgNS, 'text');
          text.setAttribute('x', x);
          text.setAttribute('y', y - 4);
          text.setAttribute('text-anchor', 'middle');
          text.setAttribute('class', 'matrix-point-text');
          text.textContent = getInitials(category.label);
          group.appendChild(text);

          var title = document.createElementNS(svgNS, 'title');
          title.textContent = category.label + ': ' + category.importance + '/5 importance, ' + category.satisfaction + '/5 satisfaction';
          group.appendChild(title);

          group.addEventListener('mouseenter', function() {
            setHighlight(category.id);
          });
          group.addEventListener('focus', function() {
            setHighlight(category.id);
          });
          group.addEventListener('click', function() {
            setHighlight(category.id);
          });

          svg.appendChild(group);
        });

        container.innerHTML = '';
        container.appendChild(svg);

        if (options && options.showTooltip) {
          var tooltip = document.createElement('div');
          tooltip.className = 'matrix-tooltip';
          container.appendChild(tooltip);
        }
      }

      function renderStep() {
        elements.preview.disabled = !isComplete();
        elements.preview.classList.toggle('is-ready', isComplete());

        var step = state.currentStep;
        var category = state.categories[state.currentCategoryIndex];
        var total = state.categories.length;

        // Update step indicator
        var stepNames = ['Importance', 'Satisfaction', 'Review', 'Print'];
        elements.stepLabel.textContent = 'Step ' + step + ' of 4';
        elements.stepName.textContent = stepNames[step - 1];

        // Update progress bar
        var progressPercent = ((step - 1) / 3) * 100;
        elements.progressBar.setAttribute('aria-valuenow', step);
        elements.progressBar.querySelector('.wizard-progress-fill').style.width = progressPercent + '%';

        if (step === 1 || step === 2) {
          var isImportance = step === 1;
          elements.title.textContent = isImportance ? 'What matters most?' : 'How satisfied are you?';
          elements.microcopy.textContent = isImportance
            ? 'Rate how important each area is to you right now.'
            : 'Be honest—how satisfied are you with each area?';
          elements.progress.textContent = (state.currentCategoryIndex + 1) + ' of ' + total;
          elements.skip.style.display = 'inline';
          elements.preview.style.display = isComplete() ? 'block' : 'none';

          elements.back.disabled = step === 1 && state.currentCategoryIndex === 0;
          elements.back.style.visibility = (step === 1 && state.currentCategoryIndex === 0) ? 'hidden' : 'visible';
          var nextText = elements.next.querySelector('.wizard-nav-text');
          if (nextText) nextText.textContent = (step === 2 && state.currentCategoryIndex === total - 1) ? 'Review' : 'Next';

          var value = isImportance ? category.importance : category.satisfaction;

          elements.content.innerHTML = '';
          var card = document.createElement('div');
          card.className = 'score-card';
          card.innerHTML = '' +
            '<div class="score-header">' +
            '  <span class="score-category">' + category.label + '</span>' +
            '</div>' +
            '<div class="score-slider">' +
            '  <div class="score-value-display">' +
            '    <span class="score-value' + (value === null ? ' is-empty' : '') + '" id="score-output">' + (value === null ? '—' : value) + '</span>' +
            '    <span class="score-max">/5</span>' +
            '  </div>' +
            '  <input id="score-input" type="range" min="1" max="5" step="1" value="' + (value || 3) + '" aria-label="' + (isImportance ? 'Importance' : 'Satisfaction') + ' rating for ' + category.label + '" aria-valuemin="1" aria-valuemax="5" aria-valuenow="' + (value || 3) + '">' +
            '  <div class="slider-labels">' +
            '    <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>' +
            '  </div>' +
            '  <div class="slider-scale"><span>Not at all</span><span>Extremely</span></div>' +
            '</div>';

          elements.content.appendChild(card);

          var input = card.querySelector('input');
          var output = card.querySelector('#score-output');

          input.addEventListener('input', function() {
            var newValue = Number(input.value);
            if (isImportance) {
              category.importance = newValue;
            } else {
              category.satisfaction = newValue;
            }
            input.setAttribute('aria-valuenow', String(newValue));
            output.textContent = newValue;
            output.classList.remove('is-empty');
          });

          return;
        }

        if (step === 3) {
          elements.title.textContent = 'Your strategy matrix';
          elements.microcopy.textContent = 'Tap any category to highlight it on the matrix.';
          elements.progress.textContent = 'Review';
          elements.skip.style.display = 'none';
          elements.preview.style.display = 'none';
          elements.back.disabled = false;
          elements.back.style.visibility = 'visible';
          var nextText = elements.next.querySelector('.wizard-nav-text');
          if (nextText) nextText.textContent = 'Print';

          elements.content.innerHTML = '';
          var panel = document.createElement('div');
          panel.className = 'results-panel';

          if (!isComplete()) {
            panel.innerHTML = '<p class="incomplete-message">Almost there! Complete all categories to see your full strategy matrix.</p>';
            elements.content.appendChild(panel);
            return;
          }

          var splits = getSplits();
          var quadrantBuckets = {
            maintain: [],
            invest: [],
            rebalance: [],
            release: []
          };

          state.categories.forEach(function(categoryItem) {
            var quadrantKey = getQuadrant(categoryItem, splits);
            var gapScore = (categoryItem.importance - splits.xSplit) + (splits.ySplit - categoryItem.satisfaction);
            quadrantBuckets[quadrantKey].push({
              id: categoryItem.id,
              label: categoryItem.label,
              importance: categoryItem.importance,
              satisfaction: categoryItem.satisfaction,
              gapScore: gapScore,
              quadrant: quadrantKey
            });
          });

          var matrixWrap = document.createElement('div');
          matrixWrap.className = 'matrix-wrapper';
          buildMatrix(matrixWrap, splits, { showTooltip: true });

          var counts = document.createElement('div');
          counts.className = 'matrix-counts';
          counts.innerHTML = '' +
            '<span>' + quadrantMeta.maintain.label + ': ' + quadrantBuckets.maintain.length + '</span>' +
            '<span>' + quadrantMeta.invest.label + ': ' + quadrantBuckets.invest.length + '</span>' +
            '<span>' + quadrantMeta.rebalance.label + ': ' + quadrantBuckets.rebalance.length + '</span>' +
            '<span>' + quadrantMeta.release.label + ': ' + quadrantBuckets.release.length + '</span>';

          var axis = document.createElement('div');
          axis.className = 'matrix-axes';
          axis.innerHTML = '<span>Current satisfaction</span><span>Importance</span>';

          var list = document.createElement('ul');
          list.className = 'summary-list';
          state.categories.forEach(function(categoryItem) {
            var quadrantKey = getQuadrant(categoryItem, splits);
            var item = document.createElement('li');
            var button = document.createElement('button');
            button.type = 'button';
            button.className = 'summary-button';
            button.setAttribute('data-category-button', categoryItem.id);
            button.innerHTML = '<span class="summary-name">' + categoryItem.label + '</span>' +
              '<span class="summary-focus">' + quadrantMeta[quadrantKey].label + '</span>' +
              '<span class="summary-note">' + quadrantMeta[quadrantKey].summary + '</span>';
            button.addEventListener('click', function() {
              setHighlight(categoryItem.id);
            });
            item.appendChild(button);
            list.appendChild(item);
          });

          var focus = getFocusNow(splits, quadrantBuckets);
          var focusCard = document.createElement('div');
          focusCard.className = 'focus-card';
          focusCard.innerHTML = '<p class="focus-title">Where to focus your energy</p><p>' + focus.message + '</p>';

          panel.appendChild(matrixWrap);
          panel.appendChild(counts);
          panel.appendChild(axis);
          panel.appendChild(list);
          panel.appendChild(focusCard);
          elements.content.appendChild(panel);

          if (!state.highlightedCategoryId && state.categories.length) {
            setHighlight(state.categories[0].id);
          } else {
            updateHighlight();
          }

          return;
        }

        if (step === 4) {
          elements.title.textContent = 'Your one-page plan';
          elements.microcopy.textContent = 'Print or save as PDF to reference all month.';
          elements.progress.textContent = 'Done';
          elements.skip.style.display = 'none';
          elements.preview.style.display = 'none';
          elements.back.disabled = false;
          elements.back.style.visibility = 'visible';
          var nextText = elements.next.querySelector('.wizard-nav-text');
          if (nextText) nextText.textContent = 'Start over';

          elements.content.innerHTML = '';
          var printLayout = document.createElement('div');
          printLayout.className = 'print-layout';

          if (!isComplete()) {
            printLayout.innerHTML = '<p class="incomplete-message">Complete all categories to generate your printable strategy plan.</p>';
            elements.content.appendChild(printLayout);
            return;
          }

          var splitsPrint = getSplits();
          var quadrantBucketsPrint = {
            maintain: [],
            invest: [],
            rebalance: [],
            release: []
          };

          state.categories.forEach(function(categoryItem) {
            var quadrantKey = getQuadrant(categoryItem, splitsPrint);
            quadrantBucketsPrint[quadrantKey].push(categoryItem);
          });

          var titleBlock = document.createElement('div');
          titleBlock.className = 'print-title';
          titleBlock.innerHTML = '<h3>Life Strategy Matrix</h3><p>Your personalized plan for where to invest your energy.</p>';

          var dateRow = document.createElement('div');
          dateRow.className = 'print-date';
          dateRow.innerHTML = '<label for="print-date-input">Date (optional)</label>' +
            '<input id="print-date-input" type="text" placeholder="Add a date">' +
            '<span class="print-date-output" aria-hidden="true"></span>';

          var matrixBlock = document.createElement('div');
          matrixBlock.className = 'matrix-wrapper';
          buildMatrix(matrixBlock, splitsPrint, { showTooltip: false });

          var focusPrint = getFocusNow(splitsPrint, {
            invest: quadrantBucketsPrint.invest.map(function(categoryItem) {
              return {
                label: categoryItem.label,
                satisfaction: categoryItem.satisfaction,
                gapScore: (categoryItem.importance - splitsPrint.xSplit) + (splitsPrint.ySplit - categoryItem.satisfaction)
              };
            }),
            rebalance: quadrantBucketsPrint.rebalance.map(function(categoryItem) {
              return {
                label: categoryItem.label,
                satisfaction: categoryItem.satisfaction
              };
            })
          });

          var focusPrintCard = document.createElement('div');
          focusPrintCard.className = 'focus-card';
          focusPrintCard.innerHTML = '<p class="focus-title">Your focus this month</p><p>' + focusPrint.message + '</p>';

          var groupedSection = document.createElement('div');
          groupedSection.className = 'grouped-section';

          var groupedHeader = document.createElement('h4');
          groupedHeader.className = 'grouped-section-title';
          groupedHeader.textContent = 'Your categories by quadrant';

          var groupedList = document.createElement('div');
          groupedList.className = 'grouped-list';
          groupedList.innerHTML = '' +
            buildGroupedList('Maintain', quadrantBucketsPrint.maintain) +
            buildGroupedList('Invest', quadrantBucketsPrint.invest) +
            buildGroupedList('Rebalance', quadrantBucketsPrint.rebalance) +
            buildGroupedList('Release', quadrantBucketsPrint.release);

          groupedSection.appendChild(groupedHeader);
          groupedSection.appendChild(groupedList);

          var tableSection = document.createElement('div');
          tableSection.className = 'table-section';

          var tableHeader = document.createElement('h4');
          tableHeader.className = 'table-section-title';
          tableHeader.textContent = 'Your scores';

          var table = document.createElement('table');
          table.className = 'scores-table';
          table.innerHTML = '<thead><tr><th>Category</th><th>Importance</th><th>Satisfaction</th></tr></thead>';
          var tbody = document.createElement('tbody');
          state.categories.forEach(function(categoryItem) {
            var row = document.createElement('tr');
            row.innerHTML = '<td>' + categoryItem.label + '</td><td>' + categoryItem.importance + '/5</td><td>' + categoryItem.satisfaction + '/5</td>';
            tbody.appendChild(row);
          });
          table.appendChild(tbody);

          tableSection.appendChild(tableHeader);
          tableSection.appendChild(table);

          var printButton = document.createElement('button');
          printButton.type = 'button';
          printButton.className = 'button button--print';
          printButton.textContent = 'Print PDF';
          printButton.addEventListener('click', function() {
            window.print();
          });

          printLayout.appendChild(titleBlock);
          printLayout.appendChild(dateRow);
          printLayout.appendChild(matrixBlock);
          printLayout.appendChild(focusPrintCard);
          printLayout.appendChild(groupedSection);
          printLayout.appendChild(tableSection);
          printLayout.appendChild(printButton);
          elements.content.appendChild(printLayout);

          var dateInput = printLayout.querySelector('#print-date-input');
          var dateOutput = printLayout.querySelector('.print-date-output');
          dateInput.addEventListener('input', function() {
            dateOutput.textContent = dateInput.value;
          });

          return;
        }
      }

      function buildGroupedList(title, items) {
        var listItems = items.map(function(item) {
          return '<li>' + item.label + '</li>';
        }).join('');
        if (!listItems) {
          listItems = '<li class="is-empty">None</li>';
        }
        return '<div class="grouped-list-block"><h4>' + title + ' (' + items.length + ')</h4><ul>' + listItems + '</ul></div>';
      }

      function saveCurrentValue() {
        var input = document.getElementById('score-input');
        if (!input) return;
        var category = state.categories[state.currentCategoryIndex];
        var value = Number(input.value);
        if (state.currentStep === 1) {
          category.importance = value;
        } else if (state.currentStep === 2) {
          category.satisfaction = value;
        }
      }

      function handleNext() {
        var total = state.categories.length;
        elements.note.textContent = '';

        // Save the current slider value before advancing
        if (state.currentStep === 1 || state.currentStep === 2) {
          saveCurrentValue();
        }

        if (state.currentStep === 1) {
          if (state.currentCategoryIndex < total - 1) {
            state.currentCategoryIndex += 1;
          } else {
            state.currentStep = 2;
            state.currentCategoryIndex = 0;
          }
          renderStep();
          return;
        }

        if (state.currentStep === 2) {
          if (state.currentCategoryIndex < total - 1) {
            state.currentCategoryIndex += 1;
          } else if (isComplete()) {
            state.currentStep = 3;
            state.currentCategoryIndex = 0;
          } else {
            renderStep();
            elements.note.textContent = 'Finish scoring all categories to see your strategy matrix.';
            return;
          }
          renderStep();
          return;
        }

        if (state.currentStep === 3) {
          state.currentStep = 4;
          renderStep();
          return;
        }

        if (state.currentStep === 4) {
          state.currentStep = 1;
          state.currentCategoryIndex = 0;
          renderStep();
        }
      }

      function handleBack() {
        var total = state.categories.length;
        elements.note.textContent = '';
        if (state.currentStep === 1) {
          if (state.currentCategoryIndex > 0) {
            state.currentCategoryIndex -= 1;
          }
          renderStep();
          return;
        }

        if (state.currentStep === 2) {
          if (state.currentCategoryIndex > 0) {
            state.currentCategoryIndex -= 1;
          } else {
            state.currentStep = 1;
            state.currentCategoryIndex = total - 1;
          }
          renderStep();
          return;
        }

        if (state.currentStep === 3) {
          state.currentStep = 2;
          state.currentCategoryIndex = total - 1;
          renderStep();
          return;
        }

        if (state.currentStep === 4) {
          state.currentStep = 3;
          renderStep();
        }
      }

      function handleSkip() {
        if (state.currentStep !== 1 && state.currentStep !== 2) return;
        elements.note.textContent = '';
        var total = state.categories.length;
        var category = state.categories[state.currentCategoryIndex];
        if (state.currentStep === 1) {
          category.importance = null;
        } else {
          category.satisfaction = null;
        }

        if (state.currentCategoryIndex < total - 1) {
          state.currentCategoryIndex += 1;
        } else if (state.currentStep === 1) {
          state.currentStep = 2;
          state.currentCategoryIndex = 0;
        }
        renderStep();
      }

      function handleReset() {
        elements.note.textContent = '';
        state.categories.forEach(function(category) {
          category.importance = null;
          category.satisfaction = null;
        });
        state.currentStep = 1;
        state.currentCategoryIndex = 0;
        state.highlightedCategoryId = null;
        renderStep();
      }

      elements.next.addEventListener('click', handleNext);
      elements.back.addEventListener('click', handleBack);
      elements.skip.addEventListener('click', handleSkip);
      elements.reset.addEventListener('click', handleReset);
      elements.preview.addEventListener('click', function() {
        if (!isComplete()) return;
        state.currentStep = 3;
        renderStep();
      });

      renderStep();
      window.addEventListener('resize', updateTooltip);
    })();
  </script>
</body>
</html>
